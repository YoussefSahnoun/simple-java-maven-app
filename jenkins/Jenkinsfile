pipeline {
  agent any

  stages {
    stage('Setup Tools') {
      steps {
        script {
          // ⚠️ Use the exact names from Global Tool Configuration
          def mvnHome = tool name: 'maven 3.9', type: 'hudson.tasks.Maven$MavenInstallation'
          def jdkHome = tool name: 'jdk-21', type: 'hudson.model.JDK'

          env.PATH = "${mvnHome}/bin:${jdkHome}/bin:${env.PATH}"
          env.JAVA_HOME = "${jdkHome}"
        }

        // Debug: confirm correct versions are used
        sh 'mvn -v'
        sh 'java -version'
      }
    }

    stage('Build') {
      steps {
        sh 'mvn clean package -DskipTests'
      }
    }
  }
}
